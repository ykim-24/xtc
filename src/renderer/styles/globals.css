@tailwind base;
@tailwind components;
@tailwind utilities;

/* Spinning animation for loading indicators */
@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

/* Dash traveling animation - line moves along the border */
@keyframes dash-travel {
  from {
    stroke-dashoffset: 0;
  }
  to {
    stroke-dashoffset: -144;
  }
}

/* Base styles */
* {
  box-sizing: border-box;
}

html,
body,
#root {
  height: 100%;
  margin: 0;
  padding: 0;
  overflow: hidden;
}

body {
  font-family: var(--font-sans);
  font-size: var(--font-size-base);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Custom scrollbar */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: #3a3a3a;
  border-radius: 0;
}

::-webkit-scrollbar-thumb:hover {
  background: #4a4a4a;
}

::-webkit-scrollbar-corner {
  background: transparent;
}

::-webkit-resizer {
  display: none;
}

/* Electron window drag */
.app-drag {
  -webkit-app-region: drag;
}

.app-no-drag {
  -webkit-app-region: no-drag;
}

/* Monaco editor overrides */
/* Font family is controlled via settings, not CSS */

/* Panel resize handles */
[data-panel-resize-handle-id] {
  transition: background-color 150ms ease;
}

[data-panel-resize-handle-id]:hover {
  background-color: var(--color-accent-primary);
}

/* Selection */
::selection {
  background-color: var(--color-accent-primary);
  color: white;
}

/* Focus outlines */
:focus-visible {
  outline: 2px solid var(--color-accent-primary);
  outline-offset: 2px;
}

/* Force font on native elements to avoid macOS system font warnings */
select, option, input, button, textarea {
  font-family: inherit;
}

/* Utility classes */
.truncate-2-lines {
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Highlight.js dark theme (GitHub Dark style) */
.hljs {
  color: #c9d1d9;
  background: transparent;
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-title,
.hljs-section,
.hljs-doctag,
.hljs-name,
.hljs-strong {
  color: #ff7b72;
}

.hljs-string,
.hljs-attr {
  color: #a5d6ff;
}

.hljs-comment,
.hljs-quote {
  color: #8b949e;
  font-style: italic;
}

.hljs-variable,
.hljs-template-variable,
.hljs-number,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-link {
  color: #79c0ff;
}

.hljs-built_in,
.hljs-builtin-name {
  color: #ffa657;
}

.hljs-function {
  color: #d2a8ff;
}

.hljs-class .hljs-title,
.hljs-title.class_ {
  color: #ffa657;
}

.hljs-attribute,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
  color: #7ee787;
}

.hljs-deletion {
  color: #ffa198;
}

.hljs-meta {
  color: #79c0ff;
}

.hljs-regexp {
  color: #7ee787;
}

/* Worktree Node Animated Borders */

/* Spinning yellow border for planning state */
.worktree-node-planning {
  position: relative;
  background: transparent;
}

.worktree-node-planning::before {
  content: '';
  position: absolute;
  inset: -2px;
  border-radius: 0.5rem;
  background: conic-gradient(from var(--angle, 0deg), #eab308, #facc15, #fde047, #facc15, #eab308);
  animation: worktree-border-spin 2s linear infinite;
  z-index: -1;
}

/* Spinning blue border for running state */
.worktree-node-running {
  position: relative;
  background: transparent;
}

.worktree-node-running::before {
  content: '';
  position: absolute;
  inset: -2px;
  border-radius: 0.5rem;
  background: conic-gradient(from var(--angle, 0deg), #3b82f6, #60a5fa, #93c5fd, #60a5fa, #3b82f6);
  animation: worktree-border-spin 2s linear infinite;
  z-index: -1;
}

@keyframes worktree-border-spin {
  to {
    --angle: 360deg;
  }
}

/* Use @property for smooth conic gradient animation */
@property --angle {
  syntax: '<angle>';
  initial-value: 0deg;
  inherits: false;
}

/* Fallback spinning animation for browsers without @property support */
@supports not (background: conic-gradient(from var(--angle), red, blue)) {
  .worktree-node-planning::before {
    background: linear-gradient(90deg, #eab308, #facc15, #eab308);
    background-size: 200% 100%;
    animation: worktree-gradient-shift 1s linear infinite;
  }

  .worktree-node-running::before {
    background: linear-gradient(90deg, #3b82f6, #60a5fa, #3b82f6);
    background-size: 200% 100%;
    animation: worktree-gradient-shift 1s linear infinite;
  }

  @keyframes worktree-gradient-shift {
    from { background-position: 0% 50%; }
    to { background-position: 200% 50%; }
  }
}

/* Solid green border for success */
.worktree-node-success {
  border: 2px solid #22c55e;
  box-shadow: 0 0 12px rgba(34, 197, 94, 0.4);
}

/* Solid red border for error */
.worktree-node-error {
  border: 2px solid #ef4444;
  box-shadow: 0 0 12px rgba(239, 68, 68, 0.4);
}

/* Default idle border */
.worktree-node-idle {
  border: 2px solid var(--color-border-primary, #374151);
}

/* Hover effect for nodes */
.worktree-node-idle:hover {
  border-color: var(--color-border-secondary, #4b5563);
}
